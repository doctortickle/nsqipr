## ---- NA Strings ----

na_strings <- c("","NULL","NA","N/A","-99","Unknown","Unknown/Not Reported","Not entered","Not documented","Unknown or N/A")

## ---- GENERIC COLUMNS TO BE PROCESSED ----
yes_no_cols <- c("electsurg","smoke","ventilat","hxcopd","ascites","hxchf","hypermed","renafail","dialysis","discancr","wndinf","steroid","wtloss","bleeddis","transfus","emergncy","sssipatos","dssipatos","ossipatos","pnapatos","ventpatos","utipatos","sepsispatos","sepshockpatos","returnor","stillinhosp","reoperation1","retorrelated","reoperation2","retor2related","reoperation3","readmission1","unplannedreadmission1","readmrelated1","readmission2","unplannedreadmission2","readmrelated2","readmission3","unplannedreadmission3","readmrelated3", "readmission4","unplannedreadmission4","readmrelated4","readmission5","unplannedreadmission5","readmrelated5", "etoh", "dnr", "cpneumon", "esovar","hxmi","prvpci","prvpcs","hxangina","hxpvd","restpain","impsens", "coma", "hemi", "hxtia","cva", "cvano", "tumorcns","para","quad","chemo","radio","pregnancy","proper30", "readmission","unplanreadmission","reoperation", "aaa_paas", "aaa_cp_renrevasc","aaa_cp_viscrevasc","aaa_cp_ler","aaa_cp_are","aaa_colitis","aaa_lei","aaa_roa", "aie_hrf_phys","aie_premed_aspirin","aie_premed_statin","aie_premed_betab","aie_ulp","aie_bleeding","aie_mi_stroke","aie_wound","aie_amputation","aie_mrtas","aio_hrf_phys","aio_premed_aspirin","aio_premed_statin","aio_premed_betab","aio_ulp","aio_bleeding","aio_mi_stroke","aio_wound","aio_mrtas","aio_amputation","col_steroid", "col_mech_bowel_prep","col_oral_antibiotic", "col_chemo", "col_margins","col_ileus", "pan_jaundice","pan_chemo","pan_radio","pan_drains","pan_drain_pod30","pan_percdrain_20140315","pan_woundprot","pan_drainsys_suctn")

numscale_cols <- c("wndclas","asaclas")

complication_cols <- c("supinfec","wndinfd","orgspcssi","dehis","oupneumo","reintub","pulembol","failwean","renainsf","oprenafl","urninfec","cnscva","cnscoma","neurodef","othgrafl","cdarrest","cdmi","othbleed","othdvt","othsysep","othseshock","othcdiff")

date_cols <- c("admyr","operyr","yrdeath","hdisdt", "admsyr","sdisdt")

integer_cols <- c("caseid","height","weight","optime","tothlos", "admqtr","htooday", "dsupinfec","dwndinfd","dorgspcssi", "ddehis", "doupneumo","dreintub", "dpulembol","dfailwean","drenainsf","doprenafl","durninfec","dcnscva", "dcnscoma", "dneurodef", "dcdarrest","dcdmi","dothbleed", "dothgrafl", "dothdvt", "dothsysep","dothseshock","dopertod","doptodis","dothcdiff", "retorpodays", "retor2podays", "readmpodays1", "readmpodays2", "readmpodays3", "readmpodays4", "readmpodays5", "dprna", "dprbun", "dprcreat", "dpralbum", "dprbili", "dprsgot", "dpralkph", "dprwbc", "dprhct", "dprplate", "dprptt", "dprpt", "dprinr", "nsupinfec", "nwndinfd", "norgspcssi", "ndehis", "noupneumo", "nreintub", "npulembol", "nfailwean", "nrenainsf", "noprenafl", "nurninfec", "ncnscva", "ncnscoma", "nneurodef", "ncdarrest", "ncdmi", "nothbleed", "nothgrafl", "nothdvt", "nothsysep", "nothseshock", "nothcdiff", "packs", "pgy", "mallamp", "rbc", "anesurg","surgane","dpatrm","anetime", "stooday","totslos", "dsdtohd","aaa_dcolitis","aaa_dlei","aaa_droa","aie_dulp","aie_dbleeding","aie_dmi_stroke","aie_dwound","aio_dulp","aio_dbleeding","aio_dmi_stroke","aio_dwound","col_nodeseval","damylase","ddrainremoval")

numeric_cols <- c("prsodm","prbun","prcreat","pralbum","prbili","prsgot","pralkph","prwbc","prhct","prplate","prptt","prinr","prpt", "mortprob","morbprob", "workrvu", "otherwrvu1", "otherwrvu2", "otherwrvu3", "otherwrvu4", "otherwrvu5", "otherwrvu6", "otherwrvu7", "otherwrvu8", "otherwrvu9", "otherwrvu10", "conwrvu1", "conwrvu2", "aaa_andiam", "pan_amylase_pod1","pan_amylase_pod230")

factor_cols <- c("fnstatus1","fnstatus2","typeintoc","airtra","opnote","attend","wound_closure","transt","readmsuspreason1","readmunrelsusp1","readmsuspreason2","readmunrelsusp2","readmsuspreason3","readmunrelsusp3","readmsuspreason4","readmunrelsusp4","readmsuspreason5","readmunrelsusp5","dischdest","anesthes","anesthes_other1","anesthes_other2","anesthes_other3","anesthes_other4","anesthes_other5","anesthes_other6","anesthes_other7","anesthes_other8", "surgspec","pan_drainsys_type","pan_oincis_type","pan_intra_antibiotics","pan_benign_tumorsize","pan_benign_histologic","pan_mstage","pan_tstage","pan_nstage","pan_malig_histologic","pan_resection","pan_drains_type","pan_gastduo","pan_reconstruction","pan_glandtext","pan_ductsize","pan_approach","pan_biliarystent","pan_lapthor","pan_percdrainage1", "pan_percdrainage2","pan_percdrainage3","pan_percdrainage4", "col_malignancym","col_malignancyt","col_malignancyn","col_approach","col_emergent","col_indication", "aie_mostsevoutcome","aie_prehemo","aie_posthemo","aie_hrf_anat","aie_sympt","aie_proc","aaa_surgind","aaa_surgap","aaa_pcl","aaa_pae","aaa_distext","aaa_mima","aaa_colitis_treat","aio_sympt","aio_hrf_anat","aio_prehemo","aio_posthemo","aio_mostsevoutcome","aio_proc")

redundant_cols <- c("prncptx", "otherproc1", "otherproc2", "otherproc3", "otherproc4", "otherproc5", "otherproc6", "otherproc7", "otherproc8", "otherproc9", "otherproc10", "concurr1", "concurr2", "concurr3", "concurr4", "concurr5", "concurr6", "concurr7", "concurr8", "concurr9", "concurr10", "cpt", "othercpt1", "othercpt2", "othercpt3", "othercpt4", "othercpt5", "othercpt6", "othercpt7", "othercpt8", "othercpt9", "othercpt10", "concpt1", "concpt2", "concpt3", "concpt4", "concpt5", "concpt6", "concpt7", "concpt8", "concpt9", "concpt10", "workrvu", "otherwrvu1", "otherwrvu2", "otherwrvu3", "otherwrvu4", "otherwrvu5", "otherwrvu6", "otherwrvu7", "otherwrvu8", "otherwrvu9", "otherwrvu10", "conwrvu1", "conwrvu2", "conwrvu3", "conwrvu4", "conwrvu5", "conwrvu6", "conwrvu7", "conwrvu8", "conwrvu9", "conwrvu10", "race_new","cpneumon","anesthes_other","anesthes_other1","anesthes_other2","anesthes_other3","anesthes_other4","anesthes_other5","anesthes_other6","anesthes_other7","anesthes_other8","readmission","unplanreadmission","reoperation","reoperation1","retorpodays","reoporcpt1","retorrelated","reoporicd91","reoperation2","retor2podays","reopor2cpt1","retor2related","reopor2icd91","reoperation3","retor3podays","reopor3cpt1","retor3related","reopor3icd91","reopor3icd101","readmission","readmission1","readmpodays1","unplanreadmission","unplannedreadmission1","readmrelated1","readmsuspreason1","readmrelicd91","readmission2","readmpodays2","unplannedreadmission2","readmrelated2","readmsuspreason2","readmrelicd92","readmission3","readmpodays3","unplannedreadmission3","readmrelated3","readmsuspreason3","readmrelicd93","readmission4","readmpodays4","unplannedreadmission4","readmrelated4","readmsuspreason4","readmrelicd94","readmission5","readmpodays5","unplannedreadmission5","readmrelated5","readmsuspreason5","readmrelicd95","readmunrelsusp1","readmunrelicd91","readmunrelsusp2","readmunrelicd92","readmunrelsusp3","readmunrelicd93","readmunrelsusp4","readmunrelicd94","readmunrelsusp5","readmunrelicd95","reopor1icd101","reopor2icd101","readmrelicd101","readmunrelicd101","readmrelicd102","readmunrelicd102","readmrelicd103","readmunrelicd103","readmrelicd104","readmunrelicd104","readmrelicd105","readmunrelicd105", "aaa_andiam_unk", "col_steroid_unk","col_oral_antibiotic_unk","col_chemo_unk","col_margins_unk","col_ileus_unk","col_mech_bowel_prep_unk", "pan_jaundice_unk", "pan_chemo_unk", "pan_radio_unk","pan_drains_unk","pan_amylase_pod1","pan_amylase_pod230","damylase","pan_amylase_pod1_unk","pan_amylase_pod230_unk","pan_amylase_unk","pan_drain_removal_unk","pan_percdrainage","pan_percdrainage1","pan_percdrainage2","pan_percdrainage3","pan_percdrainage4","pan_delgastric_20140315","col_icd9_indication", "col_icd9_emergent")

coalesce_in_cols <- c("race","pnapatos","readmission1","unplannedreadmission1","reoperation1", "col_icd10_indication", "col_icd10_emergent")

coalesce_out_cols <- c("race_new","cpneumon","readmission","unplanreadmission","reoperation", "col_icd9_indication", "col_icd9_emergent")


## ----- INDIVIDUAL PUF/TARGETED COLUMN DEFINITIONS ----
# THESE SHOULD HAVE ALL COLUMNS INCLUDING REDUNDANT COLUMNS, RENAMED (OLD AND NEW), COLUMNS CONVERTED TO LONG, AND COLUMNS ADDED BY THE UNIQUE COLUMN FUNCTIONS

acs_cols <- c("caseid","pufyear","sex","race","race_new","ethnicity_hispanic","prncptx","cpt","workrvu","inout","transt","age","admyr","admsyr","operyr","electsurg","dischdest","anesthes","anesthes_other","anesthes_other1","anesthes_other2","anesthes_other3","anesthes_other4","anesthes_other5","anesthes_other6","anesthes_other7","anesthes_other8", "attend","surgspec","height","weight","diabetes","insulin","smoke","packs","etoh","dyspnea","when_dyspnea","dnr","fnstatus1","fnstatus2","ventilat","hxcopd","cpneumon","ascites","esovar","hxchf","hxmi","prvpci","prvpcs","hxangina","hypermed","hxpvd","restpain","renafail","dialysis","impsens","coma","hemi","hxtia","cva","cvano","tumorcns","para","quad","discancr","wndinf","steroid","wtloss","bleeddis","transfus","chemo","radio","prsepis","type_prsepis","pregnancy","proper30","dprna","dprbun","dprcreat","dpralbum","dprbili","dprsgot","dpralkph","dprwbc","dprhct","dprplate","dprptt","dprpt","dprinr","prsodm","prbun","prcreat","pralbum","prbili","prsgot","pralkph","prwbc","prhct","prplate","prptt","prinr","prpt","otherproc1","othercpt1","otherwrvu1","otherproc2","othercpt2","otherwrvu2","otherproc3","othercpt3","otherwrvu3","otherproc4","othercpt4","otherwrvu4","otherproc5","othercpt5","otherwrvu5","otherproc6","othercpt6","otherwrvu6","otherproc7","othercpt7","otherwrvu7","otherproc8","othercpt8","otherwrvu8","otherproc9","othercpt9","otherwrvu9","otherproc10","othercpt10","otherwrvu10","concurr1","concpt1","conwrvu1","concurr2","concpt2","conwrvu2","concurr3","concpt3","conwrvu3","concurr4","concpt4","conwrvu4","concurr5","concpt5","conwrvu5","concurr6","concpt6","conwrvu6","concurr7","concpt7","conwrvu7","concurr8","concpt8","conwrvu8","concurr9","concpt9","conwrvu9","concurr10","concpt10","conwrvu10","opnote","pgy","emergncy","wndclas","asaclas","airtra","mallamp","rbc","anesurg","surgane","dpatrm","anetime","optime","typeintoc","sdisdt","hdisdt","yrdeath","tothlos","admqtr","htooday","stooday","totslos","nsupinfec","supinfec","dsupinfec","sssipatos","nwndinfd","wndinfd","dwndinfd","dssipatos","norgspcssi","orgspcssi","dorgspcssi","ossipatos","ndehis","dehis","ddehis","noupneumo","oupneumo","doupneumo","pnapatos","nreintub","reintub","dreintub","npulembol","pulembol","dpulembol","nfailwean","failwean","dfailwean","ventpatos","nrenainsf","renainsf","drenainsf","noprenafl","oprenafl","doprenafl","nurninfec","urninfec","durninfec","utipatos","ncnscva","cnscva","dcnscva","ncnscoma","cnscoma","dcnscoma","nneurodef","neurodef","dneurodef","ncdarrest","cdarrest","dcdarrest","ncdmi","cdmi","dcdmi","nothbleed","othbleed","dothbleed","nothgrafl","othgrafl","dothgrafl","nothdvt","othdvt","dothdvt","nothsysep","othsysep","dothsysep","sepsispatos","nothseshock","othseshock","dothseshock","sepshockpatos","othcdiff","nothcdiff","dothcdiff","podiag","podiagtx","returnor","dsdtohd","dopertod","doptodis","mortprob","morbprob","stillinhosp","reoperation","reoperation1","retorpodays","reoporcpt1","retorrelated","reoporicd91","reoperation2","retor2podays","reopor2cpt1","retor2related","reopor2icd91","reoperation3","retor3podays","reopor3cpt1","retor3related","reopor3icd91","reopor3icd101","readmission","readmission1","readmpodays1","unplanreadmission","unplannedreadmission1","readmrelated1","readmsuspreason1","readmrelicd91","readmission2","readmpodays2","unplannedreadmission2","readmrelated2","readmsuspreason2","readmrelicd92","readmission3","readmpodays3","unplannedreadmission3","readmrelated3","readmsuspreason3","readmrelicd93","readmission4","readmpodays4","unplannedreadmission4","readmrelated4","readmsuspreason4","readmrelicd94","readmission5","readmpodays5","unplannedreadmission5","readmrelated5","readmsuspreason5","readmrelicd95","readmunrelsusp1","readmunrelicd91","readmunrelsusp2","readmunrelicd92","readmunrelsusp3","readmunrelicd93","readmunrelsusp4","readmunrelicd94","readmunrelsusp5","readmunrelicd95","podiag10","podiagtx10","reopor1icd101","reopor2icd101","readmrelicd101","readmunrelicd101","readmrelicd102","readmunrelicd102","readmrelicd103","readmunrelicd103","readmrelicd104","readmunrelicd104","readmrelicd105","readmunrelicd105","wound_closure","podiag_other","podiag_other10")

aaa_cols <- c("aaa_surgind", "aaa_andiam", "aaa_andiam_unk", "aaa_paas", "aaa_surgap", "aaa_pcl", "aaa_pae", "aaa_distext", "aaa_mima", "aaa_cp_renrevasc", "aaa_cp_viscrevasc", "aaa_cp_ler", "aaa_cp_are", "aaa_colitis", "aaa_dcolitis", "aaa_colitiis_treat","aaa_colitis_treat", "aaa_lei", "aaa_dlei", "aaa_roa", "aaa_droa", "aaa_iculos")

aie_cols <- c("aie_proc", "aie_sympt", "aie_hrf_phys", "aie_hrf_anat", "aie_premed_aspirin", "aie_premed_statin", "aie_premed_betab", "aie_prehemo", "aie_ulp", "aie_dulp", "aie_bleeding", "aie_dbleeding", "aie_mi_stroke", "aie_dmi_stroke", "aie_wound", "aie_dwound", "aie_posthemo", "aie_mostsevoutcome", "aie_amputation", "aie_mrtas")

col_cols <- c("col_steroid","col_steroid_unk","col_mech_bowel_prep","col_mech_bowel_prep_unk","col_oral_antibiotic","col_oral_antibiotic_unk","col_chemo","col_chemo_unk","col_indication","col_indication_icd","col_icd9_indication","col_icd10_indication","col_emergent","col_emergent_icd","col_icd9_emergent","col_icd10_emergent","col_approach","col_open_assist","col_unplanned_conversion","col_margins","col_margins_unk","col_malignancyt","col_malignancyn","col_malignancym","col_anastomotic","col_leak_treatment","col_ileus","col_ileus_unk","col_nodeseval")

pan_cols <- c("pan_lapthor", "pan_jaundice", "pan_jaundice_unk", "pan_biliarystent", "pan_chemo", "pan_chemo_unk", "pan_radio", "pan_radio_unk", "pan_intra_antibiotics", "pan_approach","pan_open_assist","pan_unplanned_conversion", "pan_oincis_type", "pan_woundprot", "pan_ductsize", "pan_glandtext", "pan_reconstruction", "pan_gastduo", "pan_drains", "pan_drains_unk", "pan_drains_type","pan_drainsys_type", "pan_drainsys_suctn", "pan_resection", "pan_amylase_pod1", "pan_amylase_pod1_unk", "pan_amylase_pod230", "pan_amylase_pod230_unk", "damylase", "pan_amylase_unk", "ddrainremoval", "pan_drain_removal_unk", "pan_drain_pod30", "pan_fistula","pan_fistula_type","pan_fistula_intervention", "pan_delgastric_20140315","pan_delgastric","pan_delgastric_tx","pan_percdrain_20140315", "pan_percdrain", "pan_percdrainage","pan_percdrainage1", "pan_percdrainage2","pan_percdrainage3","pan_percdrainage4", "pan_malig_histologic", "pan_tstage", "pan_nstage", "pan_mstage", "pan_benign_histologic", "pan_benign_tumorsize")

add_cols <- c("dindo")

## ---- COLUMN ORDERS ----

col_order <- c(acs_cols, aaa_cols, aie_cols, col_cols, pan_cols)
